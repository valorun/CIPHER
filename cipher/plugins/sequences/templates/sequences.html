{% extends 'template.html' %} {% block content %}
<link href="{{ url_for('sequences.static', filename='vendor/vis.js/vis.min.css') }}" rel="stylesheet" type="text/css" />
<script src="{{ url_for('sequences.static', filename='vendor/vis.js/vis.js') }}"></script>
<script src="{{ url_for('sequences.static', filename='js/actionNode.js') }}"></script>
<script src="{{ url_for('sequences.static', filename='js/graphController.js') }}"></script>
<script src="{{ url_for('sequences.static', filename='js/sequencesController.js') }}"></script>
<style type="text/css">
#network {
	width: 100%;
	height: 600px;
	border: 1px solid lightgray;
}
</style>

<div class="panel">
	<div class="card round-large tertiary" id="creation">
		<button class="btn container primary block left-align accordion-header">
			<h4><i class="accordion-icon"></i> Création</h4>
		</button>
		<div  class="accordion-content">
			<div class="container padding-16">
				<i class="button secondary fas fa-plus" id="addNodeButton"></i>
				<i class="button secondary fas fa-long-arrow-alt-right" id="addTransitionButton"></i>
				<i class="button secondary fas fa-trash" id="delSelectionButton"></i>

				<div class="margin-bottom hide" id="newNodeForm">

					<select class="select border margin-bottom" name="newNodeTypeChoice">
						<option value="" disabled selected>Choisir une action</option>
						<option value="motion">Déplacement</option>
						<option value="servo">Servomoteur</option>
						<option value="servoSequence">Séquence servomoteur (COMPATIBILITE)</option>
						<option value="relay">Relai</option>
						<option value="speech">Parole</option>
						<option value="script">Script</option>
						<option value="sound">Son</option>
						<option value="pause">Pause</option>
					</select>

					<div id="motionOptions" class="row-padding">
						<div class="half">
							<label for="motion_direction">Direction:</label>
							<select class="select border" name="motion_direction" id="motion_direction">
								<option value="" disabled selected>Choisir une direction</option>
								<option value="forwards">Avant</option>
								<option value="backwards">Arrière</option>
								<option value="left">Gauche</option>
								<option value="right">Droite</option>
								<option value="stop">Stop</option>
							</select>
						</div>
						<div class="half">
							<label for="motion_speed">Vitesse:</label>
							<input type="number" id="motion_speed" value="0" class="input border" min="0" max="100">
						</div>
					</div>

					<div id="servoOptions" class="container">
						<div class="third">
							<label for="servo">Servomoteur:</label>
							<select class="select border" name="servo" id="servo">
								<option value="" disabled selected>Choisir un servomoteur</option>
								{% for s in servos %}
								{% if s.enabled %}
								<option value="{{ s.label }}"  data-default="{{ s.default_pulse_width }}" data-min="{{ s.min_pulse_width }}" data-max="{{ s.max_pulse_width }}">{{ s.label }}</option>
								{% endif %}
								{% endfor %}
							</select>
						</div>
						<div class="third">
							<label for="servo_position">Position:</label>
							<input type="number" id="servo_position" value="0" class="input border">
						</div>
						<div class="third">
							<label for="servo_speed">Vitesse:</label>
							<input type="number" id="servo_speed" value="0" class="input border" min="0" max="100">
						</div>
					</div>

					<div id="servoSequenceOptions" class="container">
						<input type="number" id="servo_sequence" value="0" class="input border" min="0" max="100">
					</div>

					<div id="relayOptions" class="container">
						<div class="half">
							<select class="select border" name="relay" id="relay">
								<option value="" disabled selected>Choisir un relai</option>
								{% for r in relays %}
								{% if r.enabled %}
								<option value="{{ r.label }}" >{{ r.label }}</option>
								{% endif %}
								{% endfor %}
							</select>
						</div>
						<div class="half">
							<input class="check" type="checkbox" checked="checked" id="relay_on_off">
							<label>On/Off</label>
						</div>
					</div>

					<div id="speechOptions" class="container">
						<label for="speech_sentence">Phrase:</label>
						<input type="text" id="speech_sentence" value="" class="input border" placeholder="Exemple: bonjour, je suis un robot">
					</div>

					<div id="scriptOptions" class="container">
						<select class="select border" name="script_name" id="script_name">
							<option value="" disabled selected>Choisir un script</option>
							{% for s in scripts %}
							{% if s %}
							<option value="{{ s }}" >{{ s }}</option>
							{% endif %}
							{% endfor %}
						</select>
					</div>

					<div id="soundOptions" class="container">
						<select class="select border" name="sound_name" id="sound_name">
							<option value="" disabled selected>Choisir un son</option>
							{% for s in sounds %}
							<option value="{{ s }}" >{{ s }}</option>
							{% endfor %}
						</select>
					</div>

					<div id="pauseOptions" class="container">
						<label for="pause">Temps(ms):</label>
						<input type="number" id="pause" value="0" class="input border" min="0">
					</div>
				</div>

				<div id="network"></div>

				<input type="text" id="name" value="" class="input border margin-bottom" placeholder="Exemple: sequence1">
				<input type="button" id="saveButton" value="Enregistrer" class="button secondary">

			</div>
		</div>
	</div>
</div>


<div class="panel">
	<div class="card round-large tertiary">
		<button class="btn container primary block left-align accordion-header">
			<h4><i class="accordion-icon"></i> Séquences enregistrées</h4>
		</button>
		<div  class="accordion-content">
			<div class="container">
				<p>
					<table class="table bordered responsive">
						{% for s in sequences %}
						<tr id="{{ s.id }}">
							<td>{{ s.id }}</td>
							<td>
								{% if s.enabled %}
								<input id="enable_{{ s.id }}" type="checkbox" name="enableSeq" checked="checked" class="check">
								{% else %}
								<input id="enable_{{ s.id }}" type="checkbox" name="enableSeq" class="check">
								{% endif %}
								<label for="enable_{{ s.id }}">activé</label>
							</td>
							<td>
								<a id="edit_{{ s.id }}" type="button" name="editSeq" class="button dark-red">
									<i class="fas fa-edit "></i>
								</a>
							</td>
							<td>
								<a id="delete_{{ s.id }}" type="button" name="deleteSeq" class="button dark-red">
									<i class="fas fa-trash"></i>
								</a>
							</td>
							<td class="hide"><div id="data_{{ s.id }}" name="dataSeq">{{ s.value }}</div></td>
						</tr>
						{% endfor %}
					</table>
				</p>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', () => {
		graphController.init();
		sequencesController.init();
	});

</script>
{% endblock %}
